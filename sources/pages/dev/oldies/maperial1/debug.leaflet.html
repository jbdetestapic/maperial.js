<html>

<head>
<title>Demo Maperial- Style Edition</title>
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">
<link href="http://code.jquery.com/ui/1.10.3/themes/smoothness/jquery-ui.css" rel="stylesheet" type="text/css" />
<link href="http://static.maperial.localhost/css/maperial-js.min.css" rel="stylesheet" type="text/css" />
<link rel="stylesheet" href="http://leafletjs.com/dist/leaflet.css" />
</head>

<body>
	<div id="map" style="width: 600px; height: 400px"></div>
	<img id="waitingSpin" src="http://static.maperial.localhost/images/mapediting/spin.gif" />
</body>

<script type="text/javascript" src="/js/tools/script-loader.js"></script>

<script type="text/javascript">
   window.scriptLoader
         .getScripts(
               [
                "http://sources.maperial.localhost/pages/dev/misc/jquery.min.js",
                "http://sources.maperial.localhost/pages/dev/misc/jquery-ui.js",
                "http://sources.maperial.localhost/pages/dev/misc/leaflet.js",
                "/js/libs/jquery.reveal.js",

                // tools
                "/js/tools/utils.js",
                "/js/libs/jquery.mousewheel.min.js",
                "/js/libs/jquery.selectbox-0.2.min.js",
                "/js/libs/jquery.validate.min.js",
                "/js/libs/proj4js-compressed.js",

                // libs
                "/js/extensions/maperialjs/libs/gl-matrix-min.js",
                "/js/extensions/maperialjs/libs/coordinate-system.js",
                "/js/extensions/maperialjs/libs/geoloc.js",
                "/js/extensions/maperialjs/libs/colorpicker.js",
                "/js/extensions/maperialjs/libs/RGBColor.js",
                "/js/extensions/maperialjs/libs/hashmap.js",
                "/js/extensions/maperialjs/libs/canvasutilities.js",
                "/js/extensions/maperialjs/libs/canvg.js",
                "/js/extensions/maperialjs/libs/StackBlur.js",
                "/js/extensions/maperialjs/libs/heatmap.js",
                "/js/extensions/maperialjs/libs/heatmap-leaflet.js",
                "/js/extensions/maperialjs/libs/QuadTree.js",

                // rendering
                "/js/extensions/maperialjs/rendering/gl-tools.js",
                "/js/extensions/maperialjs/rendering/gl-rasterlayer.js",
                "/js/extensions/maperialjs/rendering/gl-imagelayer.js",
                "/js/extensions/maperialjs/rendering/gl-shadelayer.js",
                "/js/extensions/maperialjs/rendering/gl-tile.js",
                "/js/extensions/maperialjs/rendering/gl-vectoriallayer.js",
                "/js/extensions/maperialjs/rendering/render-line.js",
                "/js/extensions/maperialjs/rendering/render-text.js",
                "/js/extensions/maperialjs/rendering/tile-renderer.js",
                "/js/extensions/maperialjs/rendering/map-renderer.js",

                // modules
                "/js/extensions/maperialjs/events.js",
                "/js/extensions/maperialjs/source.js",
                "/js/extensions/maperialjs/mouse.js",
                "/js/extensions/maperialjs/mover.js",
                "/js/extensions/maperialjs/template-builder.js",

                // hud
                "/js/extensions/maperialjs/hud/hud.js",
                "/js/extensions/maperialjs/hud/panel-composition.js",
                "/js/extensions/maperialjs/hud/panel-layer-settings.js",
                "/js/extensions/maperialjs/hud/panel-switch.js",
                "/js/extensions/maperialjs/hud/panel-controls.js",
                "/js/extensions/maperialjs/hud/panel-latlon.js",
                "/js/extensions/maperialjs/hud/panel-scale.js",
                "/js/extensions/maperialjs/hud/panel-settings.js",
                "/js/extensions/maperialjs/hud/panel-attribution.js",
                "/js/extensions/maperialjs/hud/triggers.js",

                // managers
                "/js/extensions/maperialjs/managers/config-manager.js",
                "/js/extensions/maperialjs/managers/styles-manager.js",
                "/js/extensions/maperialjs/managers/colorbars-manager.js",
                "/js/extensions/maperialjs/managers/layers-manager.js",
                "/js/extensions/maperialjs/managers/sources-manager.js",
                "/js/extensions/maperialjs/managers/layers-creation.js",

                // styleEditor
                "/js/extensions/maperialjs/styleEditor/style-editor.js",
                "/js/extensions/maperialjs/styleEditor/loader.js",
                "/js/extensions/maperialjs/styleEditor/accordion.js",
                "/js/extensions/maperialjs/styleEditor/widget-manager.js",
                "/js/extensions/maperialjs/styleEditor/zoom-manager.js",
                "/js/extensions/maperialjs/styleEditor/tools.js",
                
                // edition
                "/js/extensions/maperialjs/edition/boundingbox-drawer.js",
                "/js/extensions/maperialjs/edition/colortool.js",
                "/js/extensions/maperialjs/edition/symbolizer.js",

                // colorbar
                "/js/extensions/maperialjs/colorbar/colorbar-rainbow.js",
                "/js/extensions/maperialjs/colorbar/colorbar.js",

                "/js/extensions/maperialjs/mapView.js",
                "/js/extensions/maperialjs/maperial.js",


                  // google - geoloc
                  "https://maps.googleapis.com/maps/api/js?key=AIzaSyATwlkawyHykpfJF24jcPgL_b8kK8zO2Bc&sensor=false&libraries=places,panoramio", ],
            function() {

                  $(window).on(MaperialEvents.READY, function() {
                     $("#waitingSpin").css("display", "none")
                  })

                  var mainConfig   = ConfigManager.newConfig();
			      var lensConfig   = ConfigManager.newConfig();
			      var minifierConfig   = ConfigManager.newConfig();
			      
			      mainConfig.hud.elements[HUD.COMPOSITIONS]  = {
			         show : true,  
			         type : HUD.PANEL,    
			         label : "Composition",      
			         disableDrag : true,
			         position   : { 
			            left    : "0", 
			            top     : "40%" 
			         },
			      };
			
			      mainConfig.map.defaultZoom    = 6
			      mainConfig.map.latitude       = 51.505
			      mainConfig.map.longitude      = -0.09
			      
			      var customTransport = { 
			            type: LayersManager.Images, 
			            source: {
			               type     : Source.Images,
			               params   : { src: Source.IMAGES_STAMEN_WATERCOLOR },
			               id       : Source.IMAGES_STAMEN_WATERCOLOR
			            },
			            params: {
			               
			            },
			            composition: {
			               shader : Maperial.MulBlend,
			               params : { uParams : [ 0.38, -0.27, 3 ] }
			            }
			      }
			      
			      mainConfig.layers.push        (LayersManager.getImagesLayerConfig(Source.Images, Source.IMAGES_OCM_TRANSPORT))
			      mainConfig.layers.push        (customTransport)
			      
			      lensConfig.layers       = mainConfig.layers
			      minifierConfig.layers   = mainConfig.layers
			      
			      var mainOptions = {
			         type       : Maperial.MAIN,
			         name       : "maperialDemo"
			      }
			      
			      var lensOptions = {
			         type       : Maperial.LENS,
			         width      : "200",
			         height     : "200",
			         position   : { 
			            left    : "50%", 
			            bottom  : "27%" 
			         },
			         padding    : 2,
			         deltaZoom  : 1,
			         borderRadius: 150,
			         draggable  : true
			      }
			      
			      var minifierOptions = {
			         type       : Maperial.MINIFIER,
			         width      : "200",
			         height     : "200",
			         position   : { 
			            right   : "10%", 
			            bottom  : "18%" 
			         },
			         padding    : 2,
			         deltaZoom  : -2,
			         draggable  : true
			      }
      
                  //------------------------------------------//
                  // test leaflet
                  
                  mainConfig.useLeaflet = true
                  lensConfig.useLeaflet = true
                  minifierConfig.useLeaflet = true

                  //------------------------------------------//
			      
			      var map = {
			         views : [{
			            config  : mainConfig,
			            options : mainOptions,
			         },{
			            config  : lensConfig,
			            options : lensOptions,
			         },{
			            config  : minifierConfig,
			            options : minifierOptions,
			         }]
			      }
			         
                  //------------------------------------------//

                  var maperial = new Maperial()
            	  maperial.build([map])

               });
   
</script>


</html>


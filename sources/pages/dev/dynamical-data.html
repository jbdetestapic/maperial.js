<html>

<head>
<title>Maperial 1.2 - Dynamical data</title>
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">
<link rel="stylesheet" href="//code.jquery.com/ui/1.10.4/themes/smoothness/jquery-ui.css">
<link href="http://static.maperial.localhost/css/maperial-js.min.css" rel="stylesheet" type="text/css" />
</head>

<body>
	<div id="map"></div>
	<div id="hud"></div>
</body>

<style type="text/css">
#map {
	width: 100%;
	height: 100%;
}
</style>

<script src="//code.jquery.com/jquery-1.9.1.js"></script>
<script src="//code.jquery.com/ui/1.10.4/jquery-ui.js"></script>
<script type="text/javascript" src="//static.maperial.localhost/js/maperial.dev.js"></script>

<script type="text/javascript">
    (function() {

	    //-------------------------------------------------------//
        // data demo
	    //-------------------------------------------------------//
	
	    var batch1 = [
	        { 
	            lat     : 50.367874, 
	            lon     : 3.080601999999999, 
	            data    : { 
	                brasserie : "Abbaye de St Landelin" 
	            }
	        },
	        { 
	            lat     : 50.529722,
	            lon     : 2.931556999999998, 
	            data    : { 
	                brasserie : "Bière Lepers 8" 
	            }
	        }
	    ];
        
	    var batches = [
	        batch1,
	        batch1,
	        batch1,
	        batch1,
	        batch1,
	        batch1,
	        batch1,
	        batch1,
	        batch1,
	        batch1,
	    ];
	        
	    //-------------------------------------------------------//
	    
        var loadBatch = function (batch, dynamicalData) {
            dynamicalData.removeAll();
            batch.forEach(function(point){
                dynamicalData.addPoint(point.lat, point.lon, point.data);
            })
        }
	    
	    //-------------------------------------------------------//
        // Maperial
	    //-------------------------------------------------------//

        var maperial = new Maperial();

        //-----------------------------------------------//

        var map = maperial.addView({
            container : "map",
            defaultZoom : 9,
            latitude : 50.516584,
            longitude : 3.186998
        });

        //-----------------------------------------------//
        //Layer Images

        //map.addImageLayer(Source.IMAGES_OCM_TRANSPORT);

        //-----------------------------------------------//
        //Layer Vectorial Data 

        var brasseries = new DynamicalData();

        var options = {
            style : {
                symbol : "symbols/blue.pointer.png"
            }
        };

        map.addDynamicalLayer(brasseries, options);
        loadBatch(batches[0], brasseries);

	    //-------------------------------------------------------//
        // demo hud
	    //-------------------------------------------------------//

        var div = "<div>"
                + "<div id=\"slider\"></div>"
                + "</div>";

        $("#hud").append(div);
        
        $("#slider").slider({
           orientation  : "horizontal",
           min          : 0,
           max          : 10,
           step         : 1,
           value        : 3,
           slide        : function(){
              return function( event, ui ) {
                  var batchNum = ui.value - 1 
                  console.log("batch : " + batchNum)
                  loadBatch(batches[batchNum], brasseries);
              }
           }()
        });
	    
    })();

    
</script>


</html>

